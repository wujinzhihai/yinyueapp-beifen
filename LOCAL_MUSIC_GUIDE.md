# 🎵 本地+网络音乐混合功能使用指南

## ✨ 新功能概述

你的HarmonyOS音乐应用现在支持**本地音乐**和**网络音乐**混合播放!

---

## 📱 应用结构

### 底部导航栏 (3个标签)
```
┌─────────────────────────────────────┐
│                                     │
│         主内容区域                  │
│                                     │
├─────────────────────────────────────┤
│ 🎵 迷你播放器 (始终显示)            │
├─────────────────────────────────────┤
│ [🏠 首页] [📀 歌单] [👤 我的]       │
└─────────────────────────────────────┘
```

---

## 🏠 首页功能

### 1. 搜索栏 (支持音乐源切换)
```
┌─────────────────────────────────────┐
│ [网络音乐 ▼] 搜索歌曲、歌手    [🔍] │
└─────────────────────────────────────┘
```

**功能**:
- 下拉选择音乐源: **网络音乐** / **本地音乐**
- 网络音乐: 调用网易云API搜索
- 本地音乐: 搜索本地扫描的音乐文件

### 2. 热门推荐横幅
- 4张精美图片
- 5秒自动轮播
- 支持手动滑动

### 3. 精选推荐歌单
- 5个精选歌单
- 点击自动搜索网络音乐

---

## 📀 歌单页面

### 功能
- 显示所有本地音乐文件
- 支持刷新音乐库
- 显示音乐数量统计
- 点击播放本地音乐

### 本地音乐扫描目录
```
/storage/media/100/local/files/Music
/storage/media/100/local/files/Download
```

### 支持的音频格式
- MP3
- FLAC
- WAV
- M4A
- AAC
- OGG

---

## 👤 我的页面

### 功能
- 用户信息展示
- 播放统计
  - 本地歌曲数量
  - 播放次数
  - 收藏歌曲
- 设置选项
- 关于信息

---

## 🎵 迷你播放器

### 显示状态

#### 无歌曲时
```
┌─────────────────────────────────────┐
│ 🎵  暂无播放              ▶ (灰色)  │
│     点击搜索歌曲                    │
└─────────────────────────────────────┘
```

#### 有歌曲时
```
┌─────────────────────────────────────┐
│ 🖼️  歌曲名称              ⏸ (红色)  │
│ ↻   歌手名字                        │
└─────────────────────────────────────┘
```

### 功能
- 显示当前播放歌曲
- 封面旋转动画(播放时)
- 播放/暂停控制
- 点击跳转到播放页面

---

## 🔧 使用步骤

### 步骤1: 准备本地音乐

1. **将音乐文件放入手机**
   ```
   Music文件夹: /storage/media/100/local/files/Music
   Download文件夹: /storage/media/100/local/files/Download
   ```

2. **文件命名建议**
   ```
   格式: 歌手 - 歌名.mp3
   示例: 周杰伦 - 晴天.mp3
   ```
   这样应用会自动识别歌手和歌名

### 步骤2: 扫描本地音乐

1. 打开应用
2. 点击底部导航 **[📀 歌单]**
3. 点击右上角 **🔄 刷新按钮**
4. 等待扫描完成

### 步骤3: 播放本地音乐

#### 方法1: 从歌单播放
1. 进入 **[📀 歌单]** 页面
2. 点击任意歌曲
3. 自动跳转到播放页面

#### 方法2: 搜索播放
1. 在首页搜索栏选择 **[本地音乐]**
2. 输入歌曲名或歌手名
3. 点击搜索结果播放

### 步骤4: 播放网络音乐

1. 在首页搜索栏选择 **[网络音乐]**
2. 输入歌曲名或歌手名
3. 点击搜索结果播放

---

## 🎯 使用场景

### 场景1: 离线播放
```
1. 提前下载音乐到手机
2. 放入Music或Download文件夹
3. 打开应用,进入歌单页面
4. 刷新音乐库
5. 播放本地音乐 (无需网络)
```

### 场景2: 在线搜索
```
1. 打开应用首页
2. 选择"网络音乐"
3. 搜索想听的歌曲
4. 在线播放
```

### 场景3: 混合播放
```
1. 搜索本地音乐播放
2. 切换到网络音乐搜索
3. 添加到播放列表
4. 本地和网络音乐混合播放
```

---

## ⚙️ 权限说明

应用需要以下权限:

### 1. 网络权限
- **用途**: 搜索和播放在线音乐
- **权限**: `ohos.permission.INTERNET`

### 2. 媒体读取权限
- **用途**: 读取本地音乐文件
- **权限**: `ohos.permission.READ_MEDIA`
- **首次使用**: 需要用户授权

### 3. 媒体写入权限
- **用途**: 写入音乐文件信息
- **权限**: `ohos.permission.WRITE_MEDIA`

### 4. 后台运行权限
- **用途**: 后台播放音乐
- **权限**: `ohos.permission.KEEP_BACKGROUND_RUNNING`

---

## 📊 功能对比

| 功能 | 网络音乐 | 本地音乐 |
|------|---------|---------|
| 音乐数量 | 海量 | 有限 |
| 需要网络 | ✅ 是 | ❌ 否 |
| 流量消耗 | 高 | 无 |
| 播放速度 | 依赖网络 | 即时 |
| 音质控制 | 受限 | 完全控制 |
| 歌词显示 | ✅ 支持 | ❌ 暂不支持 |
| 封面显示 | ✅ 支持 | ❌ 默认图标 |

---

## 🎨 界面说明

### 首页
- **搜索栏**: 顶部,带音乐源选择
- **横幅**: 热门推荐,自动轮播
- **歌单**: 精选推荐,横向滚动
- **搜索结果**: 列表显示

### 歌单页面
- **标题栏**: 显示"本地音乐"
- **刷新按钮**: 右上角🔄
- **统计信息**: 显示歌曲数量
- **音乐列表**: 所有本地音乐

### 我的页面
- **用户信息**: 头像和昵称
- **统计数据**: 本地歌曲/播放次数/收藏
- **功能菜单**: 设置/历史/收藏/关于

---

## 🔍 搜索技巧

### 网络音乐搜索
```
✅ 歌曲名: "晴天"
✅ 歌手名: "周杰伦"
✅ 组合: "周杰伦 晴天"
```

### 本地音乐搜索
```
✅ 歌曲名: "晴天"
✅ 歌手名: "周杰伦"
✅ 部分匹配: "晴" (会匹配所有包含"晴"的歌曲)
```

---

## ⚠️ 注意事项

### 1. 本地音乐扫描
- 首次扫描可能需要一些时间
- 扫描结果会缓存,无需每次重新扫描
- 添加新音乐后需要手动刷新

### 2. 文件格式
- 确保音频文件格式正确
- 损坏的文件会被跳过
- 建议使用MP3或FLAC格式

### 3. 文件路径
- 必须放在指定目录
- 子目录中的文件也会被扫描
- 路径区分大小写

### 4. 权限授权
- 首次使用需要授权媒体读取权限
- 拒绝授权将无法扫描本地音乐
- 可在系统设置中重新授权

---

## 🐛 常见问题

### Q1: 为什么扫描不到本地音乐?
**A**: 
1. 检查音乐文件是否在正确的目录
2. 检查文件格式是否支持
3. 检查是否授予了媒体读取权限
4. 尝试点击刷新按钮

### Q2: 本地音乐没有封面怎么办?
**A**: 
- 本地音乐目前使用默认音符图标
- 后续版本会支持从文件中提取封面

### Q3: 本地音乐没有歌词?
**A**: 
- 本地音乐暂不支持歌词显示
- 网络音乐支持在线歌词

### Q4: 如何区分本地和网络音乐?
**A**: 
- 搜索结果中,本地音乐显示音符图标
- 网络音乐显示专辑封面
- 歌曲信息中会显示来源

---

## 🚀 后续计划

### 即将推出
- [ ] 本地音乐封面提取
- [ ] 本地音乐元数据编辑
- [ ] 播放历史记录
- [ ] 收藏功能
- [ ] 播放列表管理
- [ ] 音乐分类(歌手/专辑/流派)

---

## 📞 技术支持

如有问题,请查看:
- README.md - 项目说明
- INSTALL.md - 安装指南
- GITHUB_RELEASE_GUIDE.md - 发布指南

---

**🎉 享受你的音乐之旅!**